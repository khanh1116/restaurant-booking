classDiagram
    %% Lớp User (cha chung - đã bỏ kế thừa, dùng role)
    class User {
        -Long id
        -String phoneNumber
        -String passwordHash
        -String email
        -String fullName
        -Role role
        -DateTime createdAt
        -Boolean isActive
        +register()
        +login()
        +updateProfile()
        +changePassword()
        +isCustomer()
        +isPartner()
        +isAdmin()
    }

    %% Lớp Customer
    class Customer {
        -Long userId
        -Date dateOfBirth
        -String address
        -Integer loyaltyPoints
        -Integer totalBookings
        +createBooking()
        +viewBookingHistory()
        +cancelBooking()
        +searchRestaurants()
        +viewMenu()
        +earnPoints()
        +updateAddress()
    }

    %% Lớp Partner
    class Partner {
        -Long userId
        -String businessName
        -String businessLicense
        -String taxCode
        -Status status
        +createRestaurant()
        +updateRestaurant()
        +manageBookings()
        +confirmBooking()
        +rejectBooking()
        +addMenuItem()
        +updateMenuItem()
        +addTimeSlot()
        +viewStatistics()
    }

    %% Lớp Location
    class Location {
        -Long id
        -String city
        -String district
        -String ward
        +getFullAddress()
        +getRestaurantsByLocation()
    }

    %% Lớp Restaurant
    class Restaurant {
        -Long id
        -Long partnerId
        -String name
        -String address
        -String phoneNumber
        -String description
        -String openingHours
        -Integer slotDuration
        -Status status
        -Decimal rating
        -Long locationId
        -DateTime createdAt
        -DateTime updatedAt
        +updateInfo()
        +addImage()
        +addMenuItem()
        +addTimeSlot()
        +getAvailableSlots()
        +checkSlotAvailability()
        +calculateRating()
    }

    %% Lớp TimeSlot
    class TimeSlot {
        -Long id
        -Long restaurantId
        -Time startTime
        -Time endTime
        -Integer maxBookings
        -Boolean isActive
        +checkAvailability()
        +getCurrentBookingCount()
        +isAvailable()
        +toggleActive()
    }

    %% Lớp RestaurantImage
    class RestaurantImage {
        -Long id
        -Long restaurantId
        -String imageUrl
        -Integer displayOrder
        +updateOrder()
        +delete()
    }

    %% Lớp MenuItem
    class MenuItem {
        -Long id
        -Long restaurantId
        -String name
        -String description
        -Decimal price
        -String imageUrl
        -String category
        -Boolean isAvailable
        +updateInfo()
        +toggleAvailability()
        +delete()
        +updatePrice()
    }

    %% Lớp Booking
    class Booking {
        -Long id
        -Long customerId
        -Long restaurantId
        -Long timeSlotId
        -Date bookingDate
        -Integer numberOfGuests
        -String specialRequest
        -Status status
        -DateTime createdAt
        -DateTime confirmedAt
        +confirm()
        +reject()
        +cancel()
        +complete()
        +markNoShow()
        +sendNotification()
        +isEditable()
    }

    %% Lớp Notification
    class Notification {
        -Long id
        -Long userId
        -String title
        -String message
        -String type
        -DateTime sentAt
        -Boolean isRead
        +markAsRead()
        +send()
        +delete()
    }

    %% Quan hệ One-to-One
    User "1" -- "0..1" Customer : has
    User "1" -- "0..1" Partner : has

    %% Quan hệ giữa các lớp
    Partner "1" --> "*" Restaurant : owns
    Restaurant "*" --> "1" Location : located in
    Restaurant "1" --> "*" RestaurantImage : has
    Restaurant "1" --> "*" MenuItem : has
    Restaurant "1" --> "*" TimeSlot : has
    Restaurant "1" --> "*" Booking : receives
    
    User "1" --> "*" Booking : makes (nếu là Customer)
    Booking "*" --> "1" TimeSlot : uses
    
    User "1" --> "*" Notification : receives

    %% Notes
    note for User "role: CUSTOMER | PARTNER | ADMIN"
    note for Customer "loyaltyPoints: điểm tích lũy
totalBookings: số lần đặt bàn"
    note for Partner "status: PENDING → ACTIVE (admin duyệt)"
    note for TimeSlot "maxBookings: giới hạn số booking/khung giờ"
    note for Restaurant "slotDuration: thời gian mặc định (phút)"
    note for Booking "Status: PENDING → CONFIRMED/REJECTED"